# v2.2å®Ÿè£…ã‚µãƒãƒªãƒ¼ - è¤‡æ•°ã‚°ãƒ«ãƒ¼ãƒ—ä¸€æ‹¬ç®¡ç†æ©Ÿèƒ½

**å®Ÿè£…æ—¥**: 2026-01-22  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v2.2 (è¤‡æ•°ã‚°ãƒ«ãƒ¼ãƒ—åŒæ™‚ç·¨é›†ç‰ˆ)  
**å‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v2.1 (spec_v2.1.md)  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†

---

## ğŸ“‹ å®Ÿè£…å®Œäº†é …ç›®

### 1. ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£å±¤
- âœ… `resources/shared/utils.py`
  - `sanitize_group_name()` é–¢æ•°ã‚’è¿½åŠ 
  - ã‚°ãƒ«ãƒ¼ãƒ—åã®ç¦æ­¢æ–‡å­—ï¼ˆ`/`, `\`, `.`ï¼‰ã‚’è‡ªå‹•ç½®æ›

### 2. ã‚µãƒ¼ãƒ“ã‚¹å±¤
- âœ… `resources/services/group_service.py`
  - `create_group_with_name_as_id()` - name-as-idæ–¹å¼ã®ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ
  - `update_group_with_name_as_id()` - name-as-idæ–¹å¼ã®ã‚°ãƒ«ãƒ¼ãƒ—æ›´æ–°
  - `delete_group_with_name_as_id()` - ã‚°ãƒ«ãƒ¼ãƒ—å‰Šé™¤æ©Ÿèƒ½ï¼ˆv2.2ã§å®Ÿè£…ï¼‰

### 3. ãƒ“ãƒ¥ãƒ¼å±¤
- âœ… `resources/views/modal_views.py`
  - `create_member_settings_modal_v2()` - è¤‡æ•°ã‚°ãƒ«ãƒ¼ãƒ—åŒæ™‚ç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«ç”Ÿæˆ
  - å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—è¿½åŠ ï¼ˆæœ€å¤§10ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰
  - åˆæœŸå€¤ã®è‡ªå‹•è¨­å®šï¼ˆ`initial_value`, `initial_users`ï¼‰
  - `private_metadata` ã« `group_count` ã‚’ä¿å­˜

### 4. ãƒãƒ³ãƒ‰ãƒ©ãƒ¼å±¤
- âœ… `resources/handlers/action_handlers.py`
  - `handle_settings_v2_shortcut()` - v2.2è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºï¼ˆæ—¢å­˜ã®é–¢æ•°ã‚’æ›´æ–°ï¼‰
  - `handle_add_group_button()` - ã‚°ãƒ«ãƒ¼ãƒ—è¿½åŠ ãƒœã‚¿ãƒ³ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
  - `views.update` ã«ã‚ˆã‚‹å‹•çš„ãƒ¢ãƒ¼ãƒ€ãƒ«æ›´æ–°

- âœ… `resources/handlers/modal_handlers.py`
  - `handle_member_settings_v2_save()` - v2.2ä¿å­˜å‡¦ç†ï¼ˆcallback_id: `member_settings_v2`ï¼‰
  - `_extract_groups_from_modal()` - ãƒ¢ãƒ¼ãƒ€ãƒ«ã‹ã‚‰ã‚°ãƒ«ãƒ¼ãƒ—æŠ½å‡º
  - `_validate_modal_input()` - ã‚°ãƒ«ãƒ¼ãƒ—åé‡è¤‡ãƒã‚§ãƒƒã‚¯
  - `_calculate_diff()` - å·®åˆ†è¨ˆç®—ï¼ˆä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤ï¼‰
  - `_sync_all_groups()` - å®Œå…¨åŒæœŸå®Ÿè¡Œ

### 5. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ•´åˆæ€§
- âœ… `resources/shared/__init__.py` - `sanitize_group_name` ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- âœ… `resources/views/__init__.py` - `create_member_settings_modal_v2` ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- âœ… `resources/services/__init__.py` - æ—¢å­˜ã®æ•´åˆæ€§ã‚’ç¢ºèªï¼ˆå¤‰æ›´ãªã—ï¼‰

---

## ğŸ¯ å®Ÿè£…ã—ãŸä¸»è¦æ©Ÿèƒ½

### 1. è¤‡æ•°ã‚°ãƒ«ãƒ¼ãƒ—åŒæ™‚ç·¨é›†
- æœ€å¤§10ã‚°ãƒ«ãƒ¼ãƒ—ã‚’1ã¤ã®ãƒ¢ãƒ¼ãƒ€ãƒ«ã§ç·¨é›†å¯èƒ½
- å„ã‚°ãƒ«ãƒ¼ãƒ—ã« `#1`, `#2`, ... ã¨ãƒŠãƒ³ãƒãƒªãƒ³ã‚°
- ã‚°ãƒ«ãƒ¼ãƒ—åã¨ãƒ¡ãƒ³ãƒãƒ¼ã‚’åŒæ™‚ã«å…¥åŠ›ãƒ»ç·¨é›†

### 2. å‹•çš„ã‚°ãƒ«ãƒ¼ãƒ—è¿½åŠ 
- ã€Œâ• ã‚°ãƒ«ãƒ¼ãƒ—ã®æ–°è¦ä½œæˆã€ãƒœã‚¿ãƒ³
- ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã«æ–°ã—ã„ã‚°ãƒ«ãƒ¼ãƒ—å…¥åŠ›ã‚»ãƒƒãƒˆã‚’è¿½åŠ 
- `views.update` ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
- **å…¥åŠ›å€¤ã®ä¿æŒ**: æ—¢å­˜ã®é€šçŸ¥å…ˆã€ã‚°ãƒ«ãƒ¼ãƒ—åã€ãƒ¡ãƒ³ãƒãƒ¼ãŒæ¶ˆãˆãªã„ã‚ˆã† `initial_value` / `initial_users` ã¨ã—ã¦å†è¨­å®š

### 3. name-as-idæ–¹å¼
- ã‚°ãƒ«ãƒ¼ãƒ—åã‚’Firestoreãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¨ã—ã¦ä½¿ç”¨
- UUIDæ–¹å¼ï¼ˆv2.1ï¼‰ã‹ã‚‰ã®ç§»è¡Œ
- `sanitize_group_name()` ã§ç¦æ­¢æ–‡å­—ã‚’è‡ªå‹•ç½®æ›

### 4. å®Œå…¨åŒæœŸä¿å­˜
- ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å†…å®¹ã¨Firestoreã‚’å®Œå…¨ä¸€è‡´ã•ã›ã‚‹
- **ä½œæˆ**: ãƒ¢ãƒ¼ãƒ€ãƒ«ã«ã®ã¿å­˜åœ¨ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—
- **æ›´æ–°**: ä¸¡æ–¹ã«å­˜åœ¨ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆãƒ¡ãƒ³ãƒãƒ¼æ›´æ–°ï¼‰
- **å‰Šé™¤**: Firestoreã«ã®ã¿å­˜åœ¨ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—

---

## ğŸ”„ å‡¦ç†ãƒ•ãƒ­ãƒ¼

### A. è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«ã®åˆå›è¡¨ç¤º

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼
  â†’ ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã€Œè¨­å®šã€
  â†’ handle_settings_v2_shortcut()
    â†’ WorkspaceService.get_admin_ids()
    â†’ GroupService.get_all_groups()
    â†’ create_member_settings_modal_v2(admin_ids, groups_data)
  â†’ ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºï¼ˆæ—¢å­˜ã‚°ãƒ«ãƒ¼ãƒ—å…¨ã¦è¡¨ç¤ºï¼‰
```

### B. ã‚°ãƒ«ãƒ¼ãƒ—è¿½åŠ ãƒœã‚¿ãƒ³æŠ¼ä¸‹

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼
  â†’ ã€Œâ• ã‚°ãƒ«ãƒ¼ãƒ—ã®æ–°è¦ä½œæˆã€ã‚¯ãƒªãƒƒã‚¯
  â†’ handle_add_group_button()
    â†’ private_metadata ã‹ã‚‰ group_count å–å¾—
    â†’ state.values ã‹ã‚‰ç¾åœ¨ã®å…¥åŠ›å€¤ã‚’å–å¾—
      - admin_ids (é€šçŸ¥å…ˆ)
      - groups_data (å„ã‚°ãƒ«ãƒ¼ãƒ—åãƒ»ãƒ¡ãƒ³ãƒãƒ¼)
    â†’ group_count + 1
    â†’ create_member_settings_modal_v2(admin_ids, groups_data, new_count)
    â†’ views.update(view_id, hash, new_view)
  â†’ ãƒ¢ãƒ¼ãƒ€ãƒ«æ›´æ–°ï¼ˆæ–°ã—ã„ã‚°ãƒ«ãƒ¼ãƒ—å…¥åŠ›ã‚»ãƒƒãƒˆè¿½åŠ ï¼‰
```

### C. ä¿å­˜å‡¦ç†

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼
  â†’ ã€Œä¿å­˜ã€ãƒœã‚¿ãƒ³æŠ¼ä¸‹
  â†’ handle_member_settings_v2_save()
    â†’ 1. admin_ids ã‚’å–å¾—
    â†’ 2. _extract_groups_from_modal() ã§ã‚°ãƒ«ãƒ¼ãƒ—æŠ½å‡º
    â†’ 3. _validate_modal_input() ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    â†’ 4. GroupService.get_all_groups() ã§æ—¢å­˜ã‚°ãƒ«ãƒ¼ãƒ—å–å¾—
    â†’ 5. _calculate_diff() ã§å·®åˆ†è¨ˆç®—
    â†’ 6. _sync_all_groups() ã§å®Œå…¨åŒæœŸ
      â†’ æ–°è¦ä½œæˆï¼ˆcreate_group_with_name_as_idï¼‰
      â†’ æ›´æ–°ï¼ˆupdate_group_with_name_as_idï¼‰
      â†’ å‰Šé™¤ï¼ˆdelete_group_with_name_as_idï¼‰
    â†’ 7. WorkspaceService.save_admin_ids()
  â†’ ãƒ¢ãƒ¼ãƒ€ãƒ«é–‰ã˜ã‚‹ï¼ˆæˆåŠŸï¼‰
```

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å¤‰åŒ–

### v2.1ï¼ˆUUIDæ–¹å¼ï¼‰
```
group_id: "group_a1b2c3d4"  â† UUID
name: "å–¶æ¥­1èª²"
member_ids: ["U001", "U002"]
```

### v2.2ï¼ˆname-as-idæ–¹å¼ï¼‰
```
group_id: "å–¶æ¥­1èª²"  â† ã‚°ãƒ«ãƒ¼ãƒ—åãã®ã‚‚ã®
name: "å–¶æ¥­1èª²"      â† åŒã˜ï¼ˆäº’æ›æ€§ã®ãŸã‚ä¿æŒï¼‰
member_ids: ["U001", "U002"]
```

**äº’æ›æ€§**: v2.1ã®UUIDå½¢å¼ã‚°ãƒ«ãƒ¼ãƒ—ã‚‚å¼•ãç¶šãå‹•ä½œã—ã¾ã™ã€‚

---

## ğŸ” é‡è¦ãªå®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ

### 1. å…¥åŠ›å€¤ã®ä¿æŒï¼ˆviews.updateæ™‚ï¼‰

`views.update` ã¯æ—¢å­˜ã®å…¥åŠ›å€¤ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ãŸã‚ã€æ˜ç¤ºçš„ã«ä¿æŒã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

**å®Ÿè£…ç®‡æ‰€**: `action_handlers.py` ã® `handle_add_group_button()`

```python
# ç¾åœ¨ã®å…¥åŠ›å€¤ã‚’ä¿å­˜
admin_ids = state_values.get("admin_users_block", {})...
groups_data = []
for i in range(1, current_count + 1):
    name = state_values.get(f"group_name_{i}", {})...
    member_ids = state_values.get(f"group_members_{i}", {})...
    groups_data.append({"name": name, "member_ids": member_ids})

# æ–°ã—ã„ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’ç”Ÿæˆï¼ˆåˆæœŸå€¤ã¨ã—ã¦å†è¨­å®šï¼‰
view = create_member_settings_modal_v2(
    admin_ids=admin_ids,
    groups_data=groups_data,
    group_count=new_count
)
```

### 2. å‹•çš„ãƒ–ãƒ­ãƒƒã‚¯ç”Ÿæˆ

**å®Ÿè£…ç®‡æ‰€**: `modal_views.py` ã® `create_member_settings_modal_v2()`

```python
# ã‚°ãƒ«ãƒ¼ãƒ—å…¥åŠ›ã‚»ãƒƒãƒˆã‚’ãƒ«ãƒ¼ãƒ—ç”Ÿæˆ
for i in range(1, group_count + 1):
    # æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Œã°åˆæœŸå€¤ã¨ã—ã¦è¨­å®š
    initial_name = ""
    initial_members = []
    
    if i <= len(groups_data):
        initial_name = groups_data[i - 1].get("name", "")
        initial_members = groups_data[i - 1].get("member_ids", [])
    
    # ãƒ–ãƒ­ãƒƒã‚¯ã‚’è¿½åŠ ï¼ˆ#1, #2, ...ï¼‰
    blocks.append({
        "block_id": f"group_name_{i}",
        "element": {
            "type": "plain_text_input",
            "initial_value": initial_name  # â† ã“ã“ã§åˆæœŸå€¤è¨­å®š
        },
        "label": {"text": f"#{i}ï¼šã‚°ãƒ«ãƒ¼ãƒ—å"}
    })
    
    blocks.append({
        "block_id": f"group_members_{i}",
        "element": {
            "type": "multi_users_select",
            "initial_users": initial_members  # â† ã“ã“ã§åˆæœŸå€¤è¨­å®š
        },
        "label": {"text": f"#{i}ï¼šãƒ¡ãƒ³ãƒãƒ¼"}
    })
```

### 3. Firestoreã®ä¸€æ‹¬æ›´æ–°ï¼ˆå®Œå…¨åŒæœŸï¼‰

**å®Ÿè£…ç®‡æ‰€**: `modal_handlers.py` ã® `_sync_all_groups()`

```python
# ãƒ¢ãƒ¼ãƒ€ãƒ«ã«ã‚ã£ã¦Firestoreã«ãªã„ã‚‚ã® â†’ ä½œæˆ
for name in diff["to_create"]:
    group_service.create_group_with_name_as_id(...)

# ä¸¡æ–¹ã«ã‚ã‚‹ã‚‚ã® â†’ æ›´æ–°
for name in diff["to_update"]:
    group_service.update_group_with_name_as_id(...)

# Firestoreã«ã‚ã£ã¦ãƒ¢ãƒ¼ãƒ€ãƒ«ã«ãªã„ã‚‚ã® â†’ å‰Šé™¤
for name in diff["to_delete"]:
    group_service.delete_group_with_name_as_id(...)
```

---

## âœ… ãƒ†ã‚¹ãƒˆé …ç›®

å®Ÿè£…å®Œäº†å¾Œã€ä»¥ä¸‹ã®é …ç›®ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ã€‚

### åŸºæœ¬æ©Ÿèƒ½
- [ ] è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«ãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] æ—¢å­˜ã‚°ãƒ«ãƒ¼ãƒ—ãŒå…¨ã¦è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] é€šçŸ¥å…ˆï¼ˆç®¡ç†è€…ï¼‰ãŒåˆæœŸè¡¨ç¤ºã•ã‚Œã‚‹

### ã‚°ãƒ«ãƒ¼ãƒ—è¿½åŠ 
- [ ] ã€Œâ• ã‚°ãƒ«ãƒ¼ãƒ—ã®æ–°è¦ä½œæˆã€ãƒœã‚¿ãƒ³ã§å…¥åŠ›ã‚»ãƒƒãƒˆãŒè¿½åŠ ã•ã‚Œã‚‹
- [ ] æ—¢å­˜ã®å…¥åŠ›å€¤ï¼ˆé€šçŸ¥å…ˆã€ã‚°ãƒ«ãƒ¼ãƒ—åã€ãƒ¡ãƒ³ãƒãƒ¼ï¼‰ãŒä¿æŒã•ã‚Œã‚‹
- [ ] 10ã‚°ãƒ«ãƒ¼ãƒ—ã«é”ã™ã‚‹ã¨ãƒœã‚¿ãƒ³ãŒéè¡¨ç¤ºã«ãªã‚‹

### ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ
- [ ] æ–°ã—ã„ã‚°ãƒ«ãƒ¼ãƒ—åã¨ãƒ¡ãƒ³ãƒãƒ¼ã‚’å…¥åŠ›ã—ã¦ä¿å­˜
- [ ] Firestoreã«æ­£ã—ãä¿å­˜ã•ã‚Œã‚‹ï¼ˆgroup_id = ã‚°ãƒ«ãƒ¼ãƒ—åï¼‰

### ã‚°ãƒ«ãƒ¼ãƒ—æ›´æ–°
- [ ] æ—¢å­˜ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚’å¤‰æ›´ã—ã¦ä¿å­˜
- [ ] `member_ids` ãŒæ›´æ–°ã•ã‚Œã‚‹

### ã‚°ãƒ«ãƒ¼ãƒ—å‰Šé™¤
- [ ] ãƒ¢ãƒ¼ãƒ€ãƒ«ã‹ã‚‰å…¥åŠ›ã‚»ãƒƒãƒˆã‚’å‰Šé™¤ï¼ˆç©ºæ¬„ï¼‰ã—ã¦ä¿å­˜
- [ ] Firestoreã‹ã‚‰å‰Šé™¤ã•ã‚Œã‚‹

### å®Œå…¨åŒæœŸ
- [ ] ä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤ãŒåŒæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹
- [ ] ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å†…å®¹ã¨FirestoreãŒå®Œå…¨ä¸€è‡´ã™ã‚‹

### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- [ ] é€šçŸ¥å…ˆãŒæœªé¸æŠã®å ´åˆã€ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã‚°ãƒ«ãƒ¼ãƒ—åãŒé‡è¤‡ã—ã¦ã„ã‚‹å ´åˆã€ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹

### ã‚°ãƒ«ãƒ¼ãƒ—åã®ã‚µãƒ‹ã‚¿ã‚¤ã‚º
- [ ] ã‚°ãƒ«ãƒ¼ãƒ—åã« `/` ãŒå«ã¾ã‚Œã‚‹å ´åˆã€`_` ã«ç½®æ›ã•ã‚Œã‚‹
- [ ] ã‚°ãƒ«ãƒ¼ãƒ—åã®å…ˆé ­ãƒ»æœ«å°¾ã® `.` ãŒå‰Šé™¤ã•ã‚Œã‚‹

### æ—¢å­˜æ©Ÿèƒ½ã®äº’æ›æ€§
- [ ] æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆãŒv2.2ã®ã‚°ãƒ«ãƒ¼ãƒ—ã§æ­£å¸¸ã«ç”Ÿæˆã•ã‚Œã‚‹
- [ ] v2.1ã§ä½œæˆã—ãŸã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆUUIDæ–¹å¼ï¼‰ã‚‚è¡¨ç¤ºãƒ»ç·¨é›†å¯èƒ½

---

## ğŸ“ ã‚³ãƒ¼ãƒ‰çµ±è¨ˆ

| ãƒ•ã‚¡ã‚¤ãƒ« | è¿½åŠ è¡Œæ•° | å¤‰æ›´å†…å®¹ |
|---------|---------|---------|
| `resources/shared/utils.py` | +41 | `sanitize_group_name()` è¿½åŠ  |
| `resources/services/group_service.py` | +150 | name-as-idæ–¹å¼ã®3ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ  |
| `resources/views/modal_views.py` | +190 | `create_member_settings_modal_v2()` è¿½åŠ  |
| `resources/handlers/action_handlers.py` | +110 | ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆæ›´æ–°ã€ã‚°ãƒ«ãƒ¼ãƒ—è¿½åŠ ãƒãƒ³ãƒ‰ãƒ©ãƒ¼è¿½åŠ  |
| `resources/handlers/modal_handlers.py` | +230 | v2.2ä¿å­˜å‡¦ç†ã€4ã¤ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°è¿½åŠ  |
| `resources/shared/__init__.py` | +4 | `sanitize_group_name` ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ |
| `resources/views/__init__.py` | +1 | `create_member_settings_modal_v2` ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ |
| **åˆè¨ˆ** | **~726è¡Œ** | **7ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´** |

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### 1. ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆ
```bash
# ç’°å¢ƒå¤‰æ•°ã®è¨­å®š
export SLACK_BOT_TOKEN="xoxb-..."
export SLACK_SIGNING_SECRET="..."
export GOOGLE_APPLICATION_CREDENTIALS="path/to/serviceAccountKey.json"

# ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
python resources/main.py

# ngrokã§ãƒˆãƒ³ãƒãƒ«ä½œæˆ
ngrok http 3000
```

### 2. Slackã‚¢ãƒ—ãƒªã®è¨­å®šç¢ºèª
- ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã€Œè¨­å®šã€ãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‹
- `open_member_setup_modal` ã® callback_id ãŒæ­£ã—ã„ã‹

### 3. ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
# Google Cloud Runã«ãƒ‡ãƒ—ãƒ­ã‚¤
gcloud run deploy slack-attendance-bot \
  --source . \
  --region asia-northeast1 \
  --allow-unauthenticated
```

### 4. æœ¬ç•ªç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆ
- è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ«ã®å‹•ä½œç¢ºèª
- ã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤
- æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆã®ç”Ÿæˆ

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [spec_v2.2.md](./spec_v2.2.md) - v2.2ã®æŠ€è¡“ä»•æ§˜æ›¸
- [spec_v2.1.md](./spec_v2.1.md) - v2.1ã®æŠ€è¡“ä»•æ§˜æ›¸ï¼ˆå‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼‰
- [spec_v1.1.md](./spec_v1.1.md) - v1.1ã®æŠ€è¡“ä»•æ§˜æ›¸ï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ç‰ˆï¼‰

---

## âœ¨ ã¾ã¨ã‚

v2.2ã®å®Ÿè£…ã«ã‚ˆã‚Šã€ä»¥ä¸‹ã®æ”¹å–„ãŒå®Ÿç¾ã—ã¾ã—ãŸï¼š

1. **åŠ¹ç‡çš„ãªæ“ä½œ**: è¤‡æ•°ã‚°ãƒ«ãƒ¼ãƒ—ã‚’1å›ã®ãƒ¢ãƒ¼ãƒ€ãƒ«ã§ç·¨é›†å¯èƒ½
2. **ç›´æ„Ÿçš„ãªUI**: ã€Œâ• ã‚°ãƒ«ãƒ¼ãƒ—ã®æ–°è¦ä½œæˆã€ãƒœã‚¿ãƒ³ã§å‹•çš„ã«è¿½åŠ 
3. **å®‰å…¨ãªå‰Šé™¤**: å…¥åŠ›ã‚»ãƒƒãƒˆã‚’å‰Šé™¤ = Firestoreã‹ã‚‰å‰Šé™¤
4. **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§**: å®Œå…¨åŒæœŸã«ã‚ˆã‚Šå¸¸ã«ä¸€è‡´ã‚’ä¿è¨¼
5. **ã‚·ãƒ³ãƒ—ãƒ«ãªID**: ã‚°ãƒ«ãƒ¼ãƒ—åã‚’IDã¨ã—ã¦ä½¿ç”¨

ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã¯ãƒªãƒ³ã‚¿ãƒ¼ã‚¨ãƒ©ãƒ¼ãªã—ã§å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ï¼ğŸ‰

**å®Ÿè£…å®Œäº†æ—¥**: 2026-01-22  
**ä½œæˆè€…**: AI Assistant (Claude Sonnet 4.5)  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†ã€ãƒ†ã‚¹ãƒˆå¾…ã¡
